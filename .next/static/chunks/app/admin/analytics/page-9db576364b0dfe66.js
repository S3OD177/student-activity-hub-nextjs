(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[668],{6606:function(e,t,r){Promise.resolve().then(r.bind(r,8822))},8822:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return E}});var a=r(7437),s=r(605),l=r(9376),n=r(2265),i=r(484),c=r(3284),d=r(6070),o=r(2869),x=r(8456),m=r(5389),g=r(7168),u=r(2735),p=r(1047),h=r(265),b=r(5051),j=r(9554),f=r(5805),v=r(9663),y=r(8896),N=r(3327),w=r(525),k=r(1671),Z=r(9388),S=r(1723);function E(){let{data:e,status:t}=(0,s.useSession)(),r=(0,l.useRouter)(),{themeConfig:E}=(0,x.F)(),{t:G}=(0,m.Z)(),[C,O]=(0,n.useState)(!0),[T,R]=(0,n.useState)(!1),[_,B]=(0,n.useState)("month"),[D,A]=(0,n.useState)({overview:{},activities:{},users:{},trends:{},topActivities:[],recentEnrollments:[]});(0,n.useEffect)(()=>{"unauthenticated"===t?r.push("/login"):(null==e?void 0:e.user.role)!=="admin"?r.push("/dashboard"):F()},[t,e,r]);let F=async()=>{try{let[e,t]=await Promise.all([fetch("/api/activities"),fetch("/api/users")]),r=await e.json(),a=await t.json(),s=new Date,l=r.length,n=r.filter(e=>new Date(e.date)>s).length,i=r.filter(e=>new Date(e.date)<=s).length,c=r.reduce((e,t)=>{var r;return e+((null===(r=t._count)||void 0===r?void 0:r.enrollments)||0)},0),d=a.length,o=a.filter(e=>"user"===e.role).length,x=0,m=0;r.forEach(e=>{new Date(e.date)<=s&&e.enrollments&&e.enrollments.forEach(e=>{m++,e.attended&&x++})});let g=m>0?(x/m*100).toFixed(1):0,u=0;r.forEach(e=>{e.enrollments&&(u+=e.enrollments.filter(e=>e.certificateIssued).length)});let p={};r.forEach(e=>{let t=e.category||"General";p[t]=(p[t]||0)+1});let h=l>0?(c/l).toFixed(1):0,b=r.reduce((e,t)=>e+(t.maxStudents||0),0),j=b>0?(c/b*100).toFixed(1):0,f=r.sort((e,t)=>{var r,a;return((null===(r=t._count)||void 0===r?void 0:r.enrollments)||0)-((null===(a=e._count)||void 0===a?void 0:a.enrollments)||0)}).slice(0,5);A({overview:{totalActivities:l,upcomingActivities:n,pastActivities:i,totalEnrollments:c,totalUsers:d,activeUsers:o,certificatesIssued:u,attendanceRate:g,avgEnrollment:h,capacityUtilization:j},categories:p,activities:r,users:a,topActivities:f,growthMetrics:{activitiesGrowth:12.5,enrollmentsGrowth:18.3,usersGrowth:8.7,attendanceGrowth:5.2},statusBreakdown:{active:n,completed:i,cancelled:0}})}catch(e){console.error("Error fetching analytics:",e)}finally{O(!1),R(!1)}};if(C)return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 flex flex-col",children:[(0,a.jsx)(i.w,{}),(0,a.jsx)("main",{className:"flex-1 flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}),(0,a.jsx)(c.$,{})]});let{overview:P,categories:I,topActivities:L,growthMetrics:Y,statusBreakdown:H}=D;return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 flex flex-col",children:[(0,a.jsx)(i.w,{}),(0,a.jsx)("div",{className:"bg-gradient-to-br ".concat(E.primary," text-white py-12"),children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-4xl font-bold mb-2",children:G("analytics.title")}),(0,a.jsx)("p",{className:"text-white/90 text-lg",children:G("analytics.overview")})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(o.z,{onClick:()=>{R(!0),F()},variant:"secondary",disabled:T,className:"flex items-center gap-2",children:[(0,a.jsx)(g.Z,{className:"h-4 w-4 ".concat(T?"animate-spin":"")}),G("analytics.refresh")]}),(0,a.jsxs)(o.z,{onClick:()=>{let e=new Blob([JSON.stringify(D,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="analytics-".concat(new Date().toISOString(),".json"),r.click()},variant:"secondary",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),G("analytics.exportData")]})]})]})})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 flex-1",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[(0,a.jsx)(d.Zb,{className:"border-0 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-950 dark:to-blue-900",children:(0,a.jsxs)(d.aY,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)(p.Z,{className:"h-8 w-8 text-blue-600 dark:text-blue-400"}),(null==Y?void 0:Y.activitiesGrowth)>0?(0,a.jsx)(h.Z,{className:"h-5 w-5 text-green-600"}):(null==Y?void 0:Y.activitiesGrowth)<0?(0,a.jsx)(b.Z,{className:"h-5 w-5 text-red-600"}):(0,a.jsx)(j.Z,{className:"h-5 w-5 text-gray-600"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:G("admin.totalActivities")}),(0,a.jsx)("p",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:P.totalActivities||0}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,a.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:[P.upcomingActivities," ",G("activities.upcoming").toLowerCase()]}),(null==Y?void 0:Y.activitiesGrowth)!==void 0&&(0,a.jsxs)("span",{className:"text-xs font-medium ".concat(Y.activitiesGrowth>0?"text-green-600":Y.activitiesGrowth<0?"text-red-600":"text-gray-600"),children:[Y.activitiesGrowth>0?"+":"",Y.activitiesGrowth,"%"]})]})]})}),(0,a.jsx)(d.Zb,{className:"border-0 bg-gradient-to-br from-green-50 to-green-100 dark:from-green-950 dark:to-green-900",children:(0,a.jsxs)(d.aY,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)(f.Z,{className:"h-8 w-8 text-green-600 dark:text-green-400"}),(null==Y?void 0:Y.enrollmentsGrowth)>0?(0,a.jsx)(h.Z,{className:"h-5 w-5 text-green-600"}):(0,a.jsx)(j.Z,{className:"h-5 w-5 text-gray-600"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:G("admin.totalEnrollments")}),(0,a.jsx)("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:P.totalEnrollments||0}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,a.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:["Avg: ",P.avgEnrollment," per activity"]}),(null==Y?void 0:Y.enrollmentsGrowth)!==void 0&&(0,a.jsxs)("span",{className:"text-xs font-medium text-green-600",children:["+",Y.enrollmentsGrowth,"%"]})]})]})}),(0,a.jsx)(d.Zb,{className:"border-0 bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-950 dark:to-purple-900",children:(0,a.jsxs)(d.aY,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)(v.Z,{className:"h-8 w-8 text-purple-600 dark:text-purple-400"}),(0,a.jsx)(y.Z,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:G("admin.attendanceRate")}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:[P.attendanceRate,"%"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:"Past activities"})]})}),(0,a.jsx)(d.Zb,{className:"border-0 bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-950 dark:to-orange-900",children:(0,a.jsxs)(d.aY,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)(N.Z,{className:"h-8 w-8 text-orange-600 dark:text-orange-400"}),(0,a.jsx)(w.Z,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:G("admin.certificatesIssued")}),(0,a.jsx)("p",{className:"text-3xl font-bold text-orange-600 dark:text-orange-400",children:P.certificatesIssued||0}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:"To students"})]})})]}),(0,a.jsxs)(d.Zb,{className:"mb-6",children:[(0,a.jsx)(d.Ol,{children:(0,a.jsxs)(d.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(k.Z,{className:"h-5 w-5"}),G("analytics.statusOverview")]})}),(0,a.jsx)(d.aY,{children:(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"p-4 border-l-4 border-green-600 bg-green-50 dark:bg-green-950/30 rounded",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(k.Z,{className:"h-5 w-5 text-green-600"}),(0,a.jsx)("p",{className:"text-sm font-medium text-green-900 dark:text-green-100",children:G("analytics.active")})]}),(0,a.jsx)("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:(null==H?void 0:H.active)||0}),(0,a.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:[G("activities.upcoming")," ",G("nav.activities").toLowerCase()]})]}),(0,a.jsxs)("div",{className:"p-4 border-l-4 border-blue-600 bg-blue-50 dark:bg-blue-950/30 rounded",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(k.Z,{className:"h-5 w-5 text-blue-600"}),(0,a.jsx)("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:G("analytics.completed")})]}),(0,a.jsx)("p",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:(null==H?void 0:H.completed)||0}),(0,a.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:[G("activities.past")," ",G("nav.activities").toLowerCase()]})]}),(0,a.jsxs)("div",{className:"p-4 border-l-4 border-red-600 bg-red-50 dark:bg-red-950/30 rounded",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(Z.Z,{className:"h-5 w-5 text-red-600"}),(0,a.jsx)("p",{className:"text-sm font-medium text-red-900 dark:text-red-100",children:G("analytics.cancelled")})]}),(0,a.jsx)("p",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:(null==H?void 0:H.cancelled)||0}),(0,a.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:[G("analytics.cancelled")," ",G("nav.activities").toLowerCase()]})]})]})})]}),(0,a.jsxs)(d.Zb,{className:"mb-6",children:[(0,a.jsxs)(d.Ol,{children:[(0,a.jsxs)(d.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(w.Z,{className:"h-5 w-5"}),G("analytics.topActivities")]}),(0,a.jsx)(d.SZ,{children:G("analytics.insights")})]}),(0,a.jsx)(d.aY,{children:L&&L.length>0?(0,a.jsx)("div",{className:"space-y-3",children:L.map((e,t)=>{var r;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center font-bold text-white ".concat(0===t?"bg-yellow-500":1===t?"bg-gray-400":2===t?"bg-orange-600":"bg-blue-500"),children:t+1}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:e.title}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(e.date).toLocaleDateString()})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:(null===(r=e._count)||void 0===r?void 0:r.enrollments)||0}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"enrollments"})]})]},e.id)})}):(0,a.jsx)("p",{className:"text-center text-gray-500 py-4",children:"No activities yet"})})]}),(0,a.jsxs)(d.Zb,{className:"mt-6",children:[(0,a.jsx)(d.Ol,{children:(0,a.jsxs)(d.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(S.Z,{className:"h-5 w-5"}),G("analytics.insights")]})}),(0,a.jsx)(d.aY,{children:(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"p-4 border-l-4 border-blue-600 bg-blue-50 dark:bg-blue-950/30 rounded",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100 mb-1",children:G("analytics.engagementRate")}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:[P.activeUsers>0&&P.totalActivities>0?(P.totalEnrollments/(P.activeUsers*P.totalActivities)*100).toFixed(1):0,"%"]}),(0,a.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Users actively participating"})]}),(0,a.jsxs)("div",{className:"p-4 border-l-4 border-green-600 bg-green-50 dark:bg-green-950/30 rounded",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-green-900 dark:text-green-100 mb-1",children:G("analytics.certificateCompletion")}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:[P.totalEnrollments>0?(P.certificatesIssued/P.totalEnrollments*100).toFixed(1):0,"%"]}),(0,a.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Of enrollments completed"})]}),(0,a.jsxs)("div",{className:"p-4 border-l-4 border-purple-600 bg-purple-50 dark:bg-purple-950/30 rounded",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-purple-900 dark:text-purple-100 mb-1",children:G("analytics.successRate")}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:[P.attendanceRate,"%"]}),(0,a.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Students attending activities"})]})]})})]})]}),(0,a.jsx)(c.$,{})]})}},8456:function(e,t,r){"use strict";r.d(t,{F:function(){return c},ThemeProvider:function(){return i}});var a=r(7437),s=r(2265),l=r(2857);let n=(0,s.createContext)(void 0);function i(e){let{children:t}=e,[r,i]=(0,s.useState)("default");(0,s.useEffect)(()=>{let e=localStorage.getItem("color-theme");e&&(0,l.g)(e)&&i(e)},[]);let c=(0,l.g)(r);return(0,a.jsx)(n.Provider,{value:{currentTheme:r,setTheme:e=>{i(e),localStorage.setItem("color-theme",e)},themeConfig:c},children:t})}function c(){let e=(0,s.useContext)(n);if(!e)throw Error("useTheme must be used within ThemeProvider");return e}},2857:function(e,t,r){"use strict";r.d(t,{g:function(){return s},n:function(){return a}});let a={default:{name:"Default Blue",primary:"from-blue-600 via-purple-600 to-indigo-700",primarySolid:"bg-blue-600",primaryHover:"hover:bg-blue-700",primaryText:"text-blue-600",primaryBorder:"border-blue-500",accent:"from-blue-400 to-purple-400"},green:{name:"Forest Green",primary:"from-green-600 via-teal-600 to-emerald-700",primarySolid:"bg-green-600",primaryHover:"hover:bg-green-700",primaryText:"text-green-600",primaryBorder:"border-green-500",accent:"from-green-400 to-teal-400"},purple:{name:"Royal Purple",primary:"from-purple-600 via-indigo-600 to-violet-700",primarySolid:"bg-purple-600",primaryHover:"hover:bg-purple-700",primaryText:"text-purple-600",primaryBorder:"border-purple-500",accent:"from-purple-400 to-indigo-400"},orange:{name:"Sunset Orange",primary:"from-orange-600 via-red-600 to-pink-700",primarySolid:"bg-orange-600",primaryHover:"hover:bg-orange-700",primaryText:"text-orange-600",primaryBorder:"border-orange-500",accent:"from-orange-400 to-red-400"},pink:{name:"Rose Pink",primary:"from-pink-600 via-rose-600 to-red-700",primarySolid:"bg-pink-600",primaryHover:"hover:bg-pink-700",primaryText:"text-pink-600",primaryBorder:"border-pink-500",accent:"from-pink-400 to-rose-400"},cyan:{name:"Ocean Cyan",primary:"from-cyan-600 via-blue-600 to-indigo-700",primarySolid:"bg-cyan-600",primaryHover:"hover:bg-cyan-700",primaryText:"text-cyan-600",primaryBorder:"border-cyan-500",accent:"from-cyan-400 to-blue-400"}},s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return a[e]||a.default}}},function(e){e.O(0,[585,972,605,795,701,971,117,744],function(){return e(e.s=6606)}),_N_E=e.O()}]);